# HW04 - HTTP-—Å–µ—Ä–≤–∏—Å –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤

**–°—Ç—É–¥–µ–Ω—Ç:** –§–µ—Ö –ê–ª–µ–∫—Å–µ–π –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á
**–ì—Ä—É–ø–ø–∞:** –ò–ú–ë–û-02-24
**GitHub:** @Lishangie

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≤ `homeworks/HW04/eda-cli/` –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç:

```
eda-cli/
‚îú‚îÄ‚îÄ pyproject.toml          # –ö–æ–Ω—Ñ–∏–≥ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (FastAPI, uvicorn)
‚îú‚îÄ‚îÄ README.md               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ API
‚îú‚îÄ‚îÄ .gitignore              # Git ignore
‚îú‚îÄ‚îÄ .python-version         # Python 3.11.9
‚îú‚îÄ‚îÄ src/eda_cli/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ core.py             # –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å (HW03)
‚îÇ   ‚îú‚îÄ‚îÄ cli.py              # CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (HW03)
‚îÇ   ‚îú‚îÄ‚îÄ viz.py              # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (HW03)
‚îÇ   ‚îî‚îÄ‚îÄ api.py              # üÜï FastAPI HTTP-—Å–µ—Ä–≤–∏—Å (HW04)
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py
‚îÇ   ‚îî‚îÄ‚îÄ test_core.py        # –¢–µ—Å—Ç—ã (HW03)
‚îî‚îÄ‚îÄ data/
    ‚îî‚îÄ‚îÄ example.csv         # –ü—Ä–∏–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞
```

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### 1. `GET /health` ‚úÖ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–∏—Å–∞

```bash
curl http://localhost:8000/health
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "healthy",
  "message": "EDA Quality Service is running"
}
```

#### 2. `POST /quality` ‚úÖ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –±–∞–∑–æ–≤—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º (JSON)

```bash
curl -X POST "http://localhost:8000/quality" \
  -H "Content-Type: application/json" \
  -d '{
    "n_rows": 50,
    "n_cols": 10,
    "max_missing_share": 0.6
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "too_few_rows": true,
  "too_many_columns": false,
  "too_many_missing": true,
  "quality_score": 0.2,
  "latency_ms": 1.23
}
```

#### 3. `POST /quality-from-csv` ‚úÖ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ CSV-—Ñ–∞–π–ª–∞

```bash
curl -X POST "http://localhost:8000/quality-from-csv" \
  -F "file=@data/example.csv"
```

**–û—Ç–≤–µ—Ç:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ `/quality` (—Å–æ–¥–µ—Ä–∂–∏—Ç –±–∞–∑–æ–≤—ã–µ —Ñ–ª–∞–≥–∏)

#### 4. `POST /quality-flags-from-csv` ‚úÖ **(HW04 - –ù–û–í–´–ô –≠–ù–î–ü–û–ò–ù–¢)**

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ **–ü–û–õ–ù–û–ì–û –Ω–∞–±–æ—Ä–∞ —Ñ–ª–∞–≥–æ–≤ –∫–∞—á–µ—Å—Ç–≤–∞** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–æ—Ä–∞–±–æ—Ç–æ–∫ –∏–∑ HW03

```bash
curl -X POST "http://localhost:8000/quality-flags-from-csv" \
  -F "file=@data/example.csv"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "flags": {
    "too_few_rows": false,
    "too_many_columns": false,
    "too_many_missing": false,
    "has_constant_columns": false,
    "has_many_zero_values": false,
    "constant_columns": [],
    "zero_heavy_columns": [],
    "max_missing_share": 0.04,
    "quality_score": 0.96
  },
  "latency_ms": 12.45
}
```

---

## üîë –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è

### 1. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–î–æ–±–∞–≤–ª–µ–Ω—ã –≤ `pyproject.toml`:
- `fastapi>=0.100.0`
- `uvicorn[standard]>=0.23.0`
- `python-multipart>=0.0.6`

### 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ API

- **`api.py`** —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Pydantic** –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤
- –í–∫–ª—é—á–∞–µ—Ç **latency tracking** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∏–∑ `core.py` (HW03)

### 3. –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç (HW04)

**`POST /quality-flags-from-csv`** —Ä–µ–∞–ª–∏–∑—É–µ—Ç **–í–∞—Ä–∏–∞–Ω—Ç A** –∏–∑ –∑–∞–¥–∞–Ω–∏—è:

- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç CSV-—Ñ–∞–π–ª —á–µ—Ä–µ–∑ `UploadFile`
- –í—ã—á–∏—Å–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ñ–ª–∞–≥–æ–≤ –∫–∞—á–µ—Å—Ç–≤–∞:
  - `too_few_rows` - < 100 —Å—Ç—Ä–æ–∫
  - `too_many_columns` - > 100 —Å—Ç–æ–ª–±—Ü–æ–≤
  - `too_many_missing` - –º–∞–∫—Å –ø—Ä–æ–ø—É—Å–∫–∏ > 50%
  - **`has_constant_columns`** (HW03!) - –∫–æ–ª–æ–Ω–∫–∏ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
  - **`has_many_zero_values`** (HW03!) - —á–∏—Å–ª–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏ —Å > 60% –Ω—É–ª–µ–π
  - `quality_score` - –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–∞–ª–ª (0.0-1.0)

- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–≤–µ—Å—å —Å–ª–æ–≤–∞—Ä—å —Ñ–ª–∞–≥–æ–≤** –≤ JSON

### 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HW03

–≠–Ω–¥–ø–æ–∏–Ω—Ç –Ω–∞–ø—Ä—è–º—É—é –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ HW03:

```python
from .core import (
    compute_quality_flags,    # ‚Üê HW03 —ç–≤—Ä–∏—Å—Ç–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
    missing_table,
    summarize_dataset,
)
```

---

## üöÄ –ó–∞–ø—É—Å–∫

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞

```bash
cd homeworks/HW04/eda-cli
uv sync
```

### –ó–∞–ø—É—Å–∫ CLI

```bash
# –ë—ã—Å—Ç—Ä—ã–π –æ–±–∑–æ—Ä
uv run eda-cli overview data/example.csv

# –ü–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç
uv run eda-cli report data/example.csv --out-dir reports_example
```

### –ó–∞–ø—É—Å–∫ HTTP-—Å–µ—Ä–≤–∏—Å–∞

```bash
uv run uvicorn eda_cli.api:app --reload --port 8000
```

–¢–æ–≥–¥–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ:
- **Swagger UI:** http://localhost:8000/docs
- **ReDoc:** http://localhost:8000/redoc

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
uv run pytest -q
```

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ü–æ–ª–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HW03:** –≠–Ω–¥–ø–æ–∏–Ω—Ç `/quality-flags-from-csv` –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ —ç–≤—Ä–∏—Å—Ç–∏–∫–∏ –∏–∑ HW03, –≤–∫–ª—é—á–∞—è –Ω–æ–≤—ã–µ —Ñ–ª–∞–≥–∏ `has_constant_columns` –∏ `has_many_zero_values`.

2. **–û—Å—Ç–∞–ª—å–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:** `/health`, `/quality`, `/quality-from-csv` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∏–º–µ—Ä–∞–º —Å–µ–º–∏–Ω–∞—Ä–∞ S04 —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∞–¥–∞–ø—Ç–∞—Ü–∏—è–º–∏.

3. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞:** –°–ª–µ–¥—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∑–∞–¥–∞–Ω–∏—è - –ø—Ä–æ–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç `pyproject.toml`, –∫–∞—Ç–∞–ª–æ–≥ `src/` —Å –ø–∞–∫–µ—Ç–æ–º `eda_cli`, –∏ —Ñ–∞–π–ª `api.py` —Å HTTP-—Å–µ—Ä–≤–∏—Å–æ–º.

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ
