# üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É HW06

## –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã:

```bash
pip install pandas numpy scikit-learn matplotlib seaborn joblib
```

## –®–∞–≥ 2: –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é HW06

```bash
cd homeworks/HW06/
```

## –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ –Ω–æ—É—Ç–±—É–∫–∞

```bash
jupyter notebook HW06.ipynb
```

## ‚öôÔ∏è –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

–ù–æ—É—Ç–±—É–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:

### 1Ô∏è‚É£ **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö** (—Ä–∞–∑–¥–µ–ª 1)
- –ß–∏—Ç–∞–µ—Ç `S06-hw-dataset-02.csv`
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–∑–º–µ—Ä, —Ç–∏–ø—ã, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞
- –í—ã–≤–æ–¥–∏—Ç –±–∞–∑–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

### 2Ô∏è‚É£ **Train/Test Split** (—Ä–∞–∑–¥–µ–ª 2)
- –†–∞–∑–±–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ 75/25 (`test_size=0.25`)
- –§–∏–∫—Å–∏—Ä—É–µ—Ç `random_state=42` –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ —Ü–µ–ª–µ–≤–æ–º—É –∫–ª–∞—Å—Å—É

### 3Ô∏è‚É£ **–ë–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏** (—Ä–∞–∑–¥–µ–ª 3)
- DummyClassifier (baseline)
- LogisticRegression (baseline)

### 4Ô∏è‚É£ **GridSearchCV –¥–ª—è DecisionTree** (—Ä–∞–∑–¥–µ–ª 4)
- –ü–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `max_depth` ‚àà [5, 10, 15, 20], `min_samples_leaf` ‚àà [5, 10, 20, 30]
- CV-score: ROC-AUC –Ω–∞ 5 —Ñ–æ–ª–¥–∞—Ö train
- ‚è±Ô∏è –í—Ä–µ–º—è: ~30-60 —Å–µ–∫
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª—É—á—à—É—é –º–æ–¥–µ–ª—å

### 5Ô∏è‚É£ **GridSearchCV –¥–ª—è RandomForest** (—Ä–∞–∑–¥–µ–ª 5)
- –ü–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `n_estimators` ‚àà [50, 100, 200], `max_depth` ‚àà [10, 15, 20]
- –î–æ–±–∞–≤–ª—è–µ—Ç: `min_samples_leaf` ‚àà [5, 10, 20], `max_features` ‚àà ['sqrt', 'log2']
- CV-score: ROC-AUC –Ω–∞ 5 —Ñ–æ–ª–¥–∞—Ö train
- ‚è±Ô∏è –í—Ä–µ–º—è: ~2-5 –º–∏–Ω—É—Ç (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –ø–æ—Ç–æ–∫–∏, n_jobs=-1)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª—É—á—à—É—é –º–æ–¥–µ–ª—å

### 6Ô∏è‚É£ **GradientBoosting** (—Ä–∞–∑–¥–µ–ª 6)
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–µ –ø–æ–¥–±–∏—Ä–∞–µ—Ç—Å—è)
- –û–±—É—á–∞–µ—Ç—Å—è –Ω–∞ train –æ–¥–∏–Ω —Ä–∞–∑
- ‚è±Ô∏è –í—Ä–µ–º—è: ~10-20 —Å–µ–∫

### 7Ô∏è‚É£ **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** (—Ä–∞–∑–¥–µ–ª 7)
- –í—ã–≤–æ–¥–∏—Ç —Ç–∞–±–ª–∏—Ü—É –º–µ—Ç—Ä–∏–∫ –≤—Å–µ—Ö 5 –º–æ–¥–µ–ª–µ–π
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ª—É—á—à—É—é –º–æ–¥–µ–ª—å –ø–æ ROC-AUC

### 8Ô∏è‚É£ **ROC-–∫—Ä–∏–≤—ã–µ** (—Ä–∞–∑–¥–µ–ª 8)
- –°—Ç—Ä–æ–∏—Ç ROC-–∫—Ä–∏–≤—ã–µ –¥–ª—è 4 –º–æ–¥–µ–ª–µ–π (–≤—Å–µ –∫—Ä–æ–º–µ DummyClassifier)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `artifacts/figures/roc_curves.png`

### 9Ô∏è‚É£ **Confusion Matrix** (—Ä–∞–∑–¥–µ–ª 9)
- –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç –º–∞—Ç—Ä–∏—Ü—É –æ—à–∏–±–æ–∫ –¥–ª—è –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ (GradientBoosting)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `artifacts/figures/confusion_matrix.png`

### üîü **Permutation Importance** (—Ä–∞–∑–¥–µ–ª 10)
- –í—ã—á–∏—Å–ª—è–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è GradientBoosting
- –í—ã–≤–æ–¥–∏—Ç Top-15 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≥—Ä–∞—Ñ–∏–∫ –≤ `artifacts/figures/feature_importance.png`

### 1Ô∏è‚É£1Ô∏è‚É£ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤** (—Ä–∞–∑–¥–µ–ª 11)
- `best_model.joblib` ‚Äì —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç GradientBoosting
- `metrics_test.json` ‚Äì —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ test
- `search_summaries.json` ‚Äì —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã GridSearchCV
- `best_model_meta.json` ‚Äì –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏

## ‚è±Ô∏è –û–±—â–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

- **–ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫**: 3-7 –º–∏–Ω—É—Ç (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä–∞)
- **GridSearchCV** –∑–∞–±–∏—Ä–∞–µ—Ç –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ —É—Å–∫–æ—Ä—è—é—Ç)
- **–û—Å—Ç–∞–ª—å–Ω–æ–µ**: ~30 —Å–µ–∫

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–æ–∑–¥–∞–Ω—ã:

```
homeworks/HW06/
‚îú‚îÄ‚îÄ HW06.ipynb
‚îú‚îÄ‚îÄ report.md
‚îú‚îÄ‚îÄ S06-hw-dataset-02.csv
‚îî‚îÄ‚îÄ artifacts/
    ‚îú‚îÄ‚îÄ best_model.joblib
    ‚îú‚îÄ‚îÄ metrics_test.json
    ‚îú‚îÄ‚îÄ search_summaries.json
    ‚îú‚îÄ‚îÄ best_model_meta.json
    ‚îî‚îÄ‚îÄ figures/
        ‚îú‚îÄ‚îÄ roc_curves.png
        ‚îú‚îÄ‚îÄ confusion_matrix.png
        ‚îî‚îÄ‚îÄ feature_importance.png
```

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: `ModuleNotFoundError: No module named 'sklearn'`

**–†–µ—à–µ–Ω–∏–µ**:
```bash
pip install scikit-learn
```

### –ü—Ä–æ–±–ª–µ–º–∞: Grid SearchCV –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—á–µ–Ω—å –¥–æ–ª–≥–æ

**–†–µ—à–µ–Ω–∏–µ**: –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –ü–∞—Ä–∞–º–µ—Ç—Ä `n_jobs=-1` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–µ —è–¥—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞, –Ω–æ –ø–µ—Ä–µ–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ç—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏.
- DecisionTree: ~30-60 —Å–µ–∫
- RandomForest: ~2-5 –º–∏–Ω—É—Ç

–ï—Å–ª–∏ —Å–æ–≤—Å–µ–º –∫—Ä–∏—Ç–∏—á–Ω–æ, –º–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ `param_grid`.

### –ü—Ä–æ–±–ª–µ–º–∞: `FileNotFoundError: S06-hw-dataset-02.csv`

**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ `homeworks/HW06/`

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å—Å—è

–ù–∞ –≤—ã—Ö–æ–¥–µ –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–π —è—á–µ–π–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è:

```
‚úì –ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ artifacts/best_model.joblib
‚úì –ú–µ—Ç—Ä–∏–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ artifacts/metrics_test.json
‚úì –†–µ–∑—É–ª—å—Ç–∞—Ç—ã GridSearch —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ artifacts/search_summaries.json
‚úì –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ artifacts/best_model_meta.json
‚úì ROC –∫—Ä–∏–≤—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ artifacts/figures/roc_curves.png
‚úì Confusion matrix —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ artifacts/figures/confusion_matrix.png
‚úì Feature importance —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ artifacts/figures/feature_importance.png

==================================================
‚úì –í–°–ï –ê–†–¢–ï–§–ê–ö–¢–´ –£–°–ü–ï–®–ù–û –°–û–ó–î–ê–ù–´!
==================================================
```

## üìù –ß—Ç–æ –¥–∞–ª—å—à–µ

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ—É—Ç–±—É–∫ (`jupyter notebook HW06.ipynb`)
2. –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ —è—á–µ–π–∫–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É (Cell ‚Üí Run All)
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–æ–∑–¥–∞–Ω—ã
4. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

```bash
git add .
git commit -m "feat: –≤—ã–ø–æ–ª–Ω–µ–Ω–æ HW06 —Å GridSearchCV –∏ –≤—Å–µ–º–∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º–∏"
git push origin main
```

## üéØ –£—Å–ø–µ—Ö–∞!

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã –∏–ª–∏ –≤–æ–ø—Ä–æ—Å—ã, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- ‚úÖ –í–µ—Ä—Å–∏—é Python (3.8+)
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –ü—É—Ç—å –∫ CSV —Ñ–∞–π–ª—É
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –ø–∞–ø–∫–∏ `artifacts/figures/`
